# ==========================================
# SHARED CONFIGURATION FOR ALL SERVICES
# ==========================================
spring.banner.location=classpath:banner.txt
# ==========================================
# EUREKA CLIENT (Shared)
# ==========================================
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.prefer-ip-address=true
eureka.instance.lease-renewal-interval-in-seconds=30
eureka.instance.lease-expiration-duration-in-seconds=90

# ==========================================
# ACTUATOR (Shared)
# ==========================================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.endpoint.health.show-components=always
management.health.circuitbreakers.enabled=true
management.health.ratelimiters.enabled=true
management.health.db.enabled=true
management.health.diskspace.enabled=true

# ==========================================
# LOGGING (Shared)
# ==========================================
logging.level.root=INFO
logging.level.com.book.management=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] [${spring.application.name}] %-5level %logger{36} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] [${spring.application.name}] %-5level %logger{36} - %msg%n
logging.file.max-size=10MB
logging.file.max-history=30
logging.file.total-size-cap=100MB

# ==========================================
# JWT CONFIGURATION (Shared across services)
# ==========================================
jwt.secret=your_256_bit_secret_key_change_in_production_use_env_variable_for_security
jwt.expiration=86400000
jwt.refresh-expiration=604800000

# ==========================================
# CIRCUIT BREAKER - DEFAULT (Shared)
# ==========================================
resilience4j.circuitbreaker.configs.default.register-health-indicator=true
resilience4j.circuitbreaker.configs.default.sliding-window-size=10
resilience4j.circuitbreaker.configs.default.minimum-number-of-calls=5
resilience4j.circuitbreaker.configs.default.failure-rate-threshold=50
resilience4j.circuitbreaker.configs.default.wait-duration-in-open-state=10s
resilience4j.circuitbreaker.configs.default.permitted-number-of-calls-in-half-open-state=3
resilience4j.circuitbreaker.configs.default.slow-call-duration-threshold=2s
resilience4j.circuitbreaker.configs.default.slow-call-rate-threshold=50

# ==========================================
# RETRY - DEFAULT (Shared)
# ==========================================
resilience4j.retry.configs.default.max-attempts=3
resilience4j.retry.configs.default.wait-duration=1s
resilience4j.retry.configs.default.enable-exponential-backoff=true
resilience4j.retry.configs.default.exponential-backoff-multiplier=2

# ==========================================
# RATE LIMITER - DEFAULT (Shared)
# ==========================================
resilience4j.ratelimiter.configs.default.limit-for-period=100
resilience4j.ratelimiter.configs.default.limit-refresh-period=1s
resilience4j.ratelimiter.configs.default.timeout-duration=0s

# ==========================================
# JACKSON (Shared)
# ==========================================
spring.jackson.time-zone=UTC
spring.jackson.default-property-inclusion=non_null

# ==========================================
# TRANSACTION (Shared)
# ==========================================
spring.transaction.default-timeout=30
spring.transaction.rollback-on-commit-failure=true

# ==========================================
# FEIGN CLIENT (Shared)
# ==========================================
feign.client.config.default.connect-timeout=5000
feign.client.config.default.read-timeout=5000
feign.client.config.default.logger-level=full

# ==========================================
# GATEWAY SECURITY - Block Direct Access (Shared)
# ==========================================
# Only accept requests from API Gateway (reject direct access)
# Each service inherits this; can be overridden per service if needed
gateway.security.enabled=true
gateway.security.header-name=X-Gateway-Secret
gateway.security.expected-token=dev-gateway-secret-change-in-production

# Public endpoints that bypass gateway validation (for health checks and Swagger)
gateway.security.public-paths=/actuator/health,/actuator/info,/swagger-ui,/swagger-ui.html,/v3/api-docs,/webjars,/api-docs
